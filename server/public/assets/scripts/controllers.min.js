/*! clothing_app 2015-12-03 */
myApp.controller("MainController",["$scope","$http","$uibModal","$window","$anchorScroll","$location","DataService",function(a,b,c,d,e,f,g){a.dataService=g,a.itemFilter={},a.user={},a.items={},a.search=void 0,a.query=!1,a.itemsPerPage=12,a.displayPage=1,a.order="price";var h=angular.element(d),i=document,j=i.documentElement,k=i.getElementsByTagName("body")[0],l=h.innerWidth||j.clientWidth||k.clientWidth;a.sizes=a.dataService.sizeData(),a.types=a.dataService.typeData(),a.updateUserData=function(){a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData()})},void 0===a.dataService.peopleData()&&a.updateUserData(),a.updateUserData(),a.updateSaleData=function(){a.dataService.getSaleItems().then(function(){a.items=a.dataService.saleItems()})},void 0===a.dataService.saleItems()&&a.updateSaleData(),a.updateSaleData(),a.pageChanged=function(){console.log("page changed to",a.displayPage),f.hash("boxContainer"),e()},a.modalSize=function(){return l>767?"md":"sm"},a.toggle=!0,h.bind("resize",function(){console.log(a.toggle),console.log("resize"),l=h.innerWidth||j.clientWidth||k.clientWidth,console.log("width",l),l>767&&a.$apply(function(){a.toggle=!0})}),a.open=function(b){var d=c.open({animation:!0,templateUrl:"templates/viewItemModal.html",controller:"ViewItemController",size:a.modalSize(),resolve:{item:function(){return b}}});d.result.then(function(){console.log("closed")})},a.logFilter=function(){var b={};for(var c in a.itemFilter){b[c]=[];for(var d in a.itemFilter[c])a.itemFilter[c][d]&&b[c].push(d)}for(c in b){a.query=!1;for(var e=0;e<b[c].length;e++)if(b[c][e]){a.query=!0;break}}a.query?a.dataService.queryItems(b).then(function(){a.items=a.dataService.saleItems()}):a.updateSaleData()},a.searchItems=function(){console.log(a.search),a.search?a.dataService.searchItems(a.search).then(function(){a.items=a.dataService.saleItems(),console.log(a.items)}):a.updateSaleData(),a.search=""}}]),myApp.controller("ViewItemController",["$scope","$http","$uibModalInstance","DataService","item",function(a,b,c,d,e){a.item=e,a.user={},a.dataService=d,a.findUser=function(){return b.get("/user/seller",{params:{id:e.user_id}}).then(function(b){console.log("the seller",b),a.user=b.data[0]})},a.ok=function(){console.log(a.user),c.close("submitted")},a.cancel=function(){c.dismiss("cancel")},a.findUser()}]),myApp.controller("MyAccountController",["$scope","$http","DataService",function(a,b,c){console.log("ur in the account now"),a.dataService=c,a.updateUserData=function(){a.dataService.retrieveData().then(function(){a.user=a.dataService.peopleData()})},void 0===a.dataService.peopleData()?a.updateUserData():a.user=a.dataService.peopleData()}]),myApp.controller("MyClosetController",["$scope","$http","$uibModal","$window","DataService",function(a,b,c,d,e){console.log("ur in the closet"),a.dataService=e,a.updateItemData=function(){console.log("updating"),a.dataService.getUserItems().then(function(){a.items=a.dataService.userItems(),console.log(a.items)})},void 0===a.dataService.userItems()&&a.updateItemData(),a.items=a.dataService.userItems(),console.log(a.items);var f=angular.element(d),g=document,h=g.documentElement,i=g.getElementsByTagName("body")[0],j=f.innerWidth||h.clientWidth||i.clientWidth;f.innerHeight||h.clientHeight||i.clientHeight;a.modalSize=function(){return j>767?"lg":"sm"},a.open=function(){var b=c.open({animation:!0,templateUrl:"templates/addItemModal.html",controller:"AddItemController",size:a.modalSize()});b.result.then(function(){console.log("closed"),a.updateItemData(),setTimeout(a.updateItemData(),5e3)})},a.remove=function(c){console.log(c),b["delete"]("/item",{params:{id:c._id}}).then(function(b){console.log(b),a.updateItemData()})}}]),myApp.controller("AddItemController",["$scope","$http","$uibModalInstance","DataService","Upload",function(a,b,c,d,e){a.item={},a.dataService=d,a.types=a.dataService.typeData(),a.sizes=a.dataService.sizeData(),a.upload=function(){return e.upload({url:"../upload/url",data:{file:a.file}}).success(function(c){console.log(c,"uploaded"),console.log("item before insertion",a.item),a.item.url=c.secure_url,console.log("item after insertion",a.item),b.post("/item",a.item).then(function(b){a.dataService.getUserItems(),console.log(b,"posted")}),a.item={}})},a.ok=function(){console.log(a.item),a.upload(),c.close("submitted")},a.cancel=function(){c.dismiss("cancel")}}]);